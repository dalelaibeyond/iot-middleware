# V5008 Device Message Reference

Quick reference for V5008 IoT gateway message formats and topics.

## Message Types & Topics

| Type | Topic Pattern | Identifier |
|------|---------------|------------|
| Heartbeat | `V5008Upload/{device_id}/OpeAck` | `CB`/`CC` |
| RFID | `V5008Upload/{device_id}/LabelState` | `BB` |
| Temperature & Humidity | `V5008Upload/{device_id}/TemHum` | - |
| Noise | `V5008Upload/{device_id}/Noise` | - |
| Door | `V5008Upload/{device_id}/OpeAck` | `BA` |
| Device Info | `V5008Upload/{device_id}/OpeAck` | `EF01` |
| Module Info | `V5008Upload/{device_id}/OpeAck` | `EF02` |

## Message Formats

### Heartbeat (CB/CC)
```
[CB or CC] ([num + modId(4B) + uCount] x 10) [msgCode(4B)]
```

### RFID (BB)
```
[BB][modNum][modId(4B)][Reserved][uCount][rfidCount] ([num + alarm + rfid(4B)] x rfidCount) [msgCode(4B)]
```

### Temperature & Humidity
```
[modNum][modId(4B)] ([add + temp(4B) + hum(4B)] x 6) [msgCode(4B)]
```

### Noise
```
[modNum][modId(4B)] ([add + noise(4B)] x 3) [msgCode(4B)]
```

### Door (BA)
```
[BA][modNum][modId(4B)][status] [msgCode(4B)]
```

### Device Info (EF01)
```
[EF][01][deviceType(2B)][fmVersion(4B)][ip(4B)][mask(4B)][gateway(4B)][mac(6B)][msgCode(4B)]
```

### Module Info (EF02)
```
[EF][02] ([add + fmVersion(6B)] x N) [msgCode(4B)]
```

## Common JSON Structure
```json
{
  "deviceId": "<device_id>",
  "deviceType": "V5008",
  "msgType": "<type>",
  "sensorType": "<sensor_type>",
  "modNum": <module_number>,
  "modId": "<module_id>",
  "ts": "<timestamp>",
  "payload": {...},
  "meta": {
    "rawTopic": "<original_topic>",
    "rawHexString": "<hex_data>",
    "msgId": <message_code_as_integer>
  }
}
```

## Notes
- All raw messages are hex strings
- 1 byte = 2 hex characters
- Multi-byte values noted as (nB)
- Temperature/humidity values: integer.fraction format
- Valid module addresses: 1-5